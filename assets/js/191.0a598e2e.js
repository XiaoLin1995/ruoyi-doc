(window.webpackJsonp=window.webpackJsonp||[]).push([[191],{548:function(t,e,s){"use strict";s.r(e);var a=s(15),r=Object(a.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("p",[t._v("本章节，介绍项目的短信功能。该功能提供统一的短信 API 给其它模块，使它们可以快速接入短信功能，无需关心不同短信平台的具体对接。")]),t._v(" "),e("p",[t._v("短信采用异步发送，基于 "),e("a",{attrs:{href:"/message-queue/event"}},[t._v("消息队列")]),t._v("，如下图所示：")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/%E7%9F%AD%E4%BF%A1%E9%85%8D%E7%BD%AE/01.png",alt:"整体流程"}})]),t._v(" "),e("p",[t._v("该功能由 "),e("code",[t._v("yudao-module-system")]),t._v(" 模块实现，其中：")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-system/src/main/java/cn/iocoder/yudao/module/system/service/sms/",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("service/sms")]),e("OutboundLink")],1),t._v("：短信【业务】，提供短信渠道、模板的配置，短信日志的查看，短信的发送等功能")]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/tree/master/yudao-module-system/src/main/java/cn/iocoder/yudao/module/system/framework/sms",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("frameowrk/sms")]),e("OutboundLink")],1),t._v("：短信【组件】，封装阿里云、腾讯云、华为云、七牛云等短信平台的客户端。")])]),t._v(" "),e("h2",{attrs:{id:"_1-表结构"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-表结构"}},[t._v("#")]),t._v(" 1. 表结构")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/%E7%9F%AD%E4%BF%A1%E9%85%8D%E7%BD%AE/02.png",alt:"表结构"}})]),t._v(" "),e("h2",{attrs:{id:"_2-短信配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-短信配置"}},[t._v("#")]),t._v(" 2. 短信配置")]),t._v(" "),e("p",[t._v("本小节，讲解如何配置短信功能，整个过程如下：")]),t._v(" "),e("ul",[e("li",[t._v("新建一个短信【渠道】，配置对应短信平台的账号")]),t._v(" "),e("li",[t._v("新建一个短信【模版】，配置对应短信平台的模板")]),t._v(" "),e("li",[t._v("测试该短信模板，查看对应的短信【日志】，确认是否发送成功")])]),t._v(" "),e("h3",{attrs:{id:"_2-1-新建短信渠道"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-新建短信渠道"}},[t._v("#")]),t._v(" 2.1 新建短信渠道")]),t._v(" "),e("p",[t._v("① 点击 [系统管理 -> 消息中心 -> 短信管理 -> 短信渠道] 菜单，查看短信渠道的列表。如下图所示：")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/%E7%9F%AD%E4%BF%A1%E9%85%8D%E7%BD%AE/03.png",alt:"短信渠道的列表"}})]),t._v(" "),e("p",[t._v("② 点击 [新增] 按钮，选择渠道编码为【调试（钉钉）】，并填写信息如下图：")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/%E7%9F%AD%E4%BF%A1%E9%85%8D%E7%BD%AE/04.png",alt:"短信渠道的新增"}})]),t._v(" "),e("div",{staticClass:"language-YAML extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("短信 API 的账号")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 696b5d8ead48071237e4aa5861ff08dbadb2b4ded1c688a7b7c9afc615579859\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("短信 API 的密钥")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" SEC5c4e5ff888bc8a9923ae47f59e7ccd30af1f14d93c55b4e2c9cb094e35aeed67\n")])])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("疑问 1：为什么选择渠道编码为【调试（钉钉）】？")]),t._v(" "),e("p",[t._v("该类型使用钉钉机器人来模拟短信发送，用于日常调试。")]),t._v(" "),e("ul",[e("li",[t._v("短信 API 的账号，对应机器人的 Webhook 的 "),e("code",[t._v("access_token")]),t._v(" 参数")]),t._v(" "),e("li",[t._v("短信 API 的密钥，对应机器人的安全设置的加签")])]),t._v(" "),e("p",[t._v("上图使用的配置，是艿艿自己的钉钉机器人。正式使用时，必须参考 "),e("a",{attrs:{href:"https://open.dingtalk.com/document/group/custom-robot-access",target:"_blank",rel:"noopener noreferrer"}},[t._v("《钉钉开放平台 —— 自定义机器人接入 》"),e("OutboundLink")],1),t._v(" 文档，申请自己的专属机器人。")])]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("疑问 2：可以选择其它渠道编码吗？")]),t._v(" "),e("p",[t._v("当然可以，这里主要考虑部分同学暂时没有申请短信平台，所以使用【调试（钉钉）】渠道编码。")]),t._v(" "),e("p",[t._v("不同短信平台的配置，可见 "),e("a",{attrs:{href:"#_6-%E7%9F%AD%E4%BF%A1%E5%B9%B3%E5%8F%B0%E9%99%84%E5%BD%95"}},[t._v("「6. 短信平台附录」")]),t._v(" 小节。")])]),t._v(" "),e("h3",{attrs:{id:"_2-2-新建短信模板"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-新建短信模板"}},[t._v("#")]),t._v(" 2.2 新建短信模板")]),t._v(" "),e("p",[t._v("① 点击 [系统管理 -> 消息中心 -> 短信管理 -> 短信模板] 菜单，查看短信模板的列表。如下图所示：")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/%E7%9F%AD%E4%BF%A1%E9%85%8D%E7%BD%AE/05.png",alt:"短信模板的新增"}})]),t._v(" "),e("p",[t._v("② 点击 [新增] 按钮，选择刚创建的短信渠道，并填写信息如下图：")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/%E7%9F%AD%E4%BF%A1%E9%85%8D%E7%BD%AE/06.png",alt:"短信模板的新增"}})]),t._v(" "),e("ul",[e("li",[t._v("短信渠道编号：发送该短信模板时，使用的短信渠道，即使用哪个短信平台进行发送")]),t._v(" "),e("li",[t._v("模板编号：短信模板的唯一标识，使用短信 API 时，通过它标识使用的短信模板")]),t._v(" "),e("li",[t._v("模板内容：短信模板的内容，使用 "),e("code",[t._v("{var}")]),t._v(" 作为占位符，例如说 "),e("code",[t._v("{name}")]),t._v("、"),e("code",[t._v("{code}")]),t._v(" 等")]),t._v(" "),e("li",[t._v("短信 API 模板编号：短信平台的短信模板的编号，需要保证该模板在短信平台已经审核通过")]),t._v(" "),e("li",[t._v("开启状态：短信模板被禁用时，该短信模板将不发送短信，只记录短信日志")])]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("疑问：为什么设计短信模板的功能？")]),t._v(" "),e("p",[t._v("在一些场景下，需要修改短信模板所使用的短信平台。例如说：短信平台出现故障，或者切换短信平台等等。")]),t._v(" "),e("p",[t._v("此时，只需要修改短信模板的两个属性：短信渠道编号、短信 API 模板编号，无需重启应用。")])]),t._v(" "),e("h3",{attrs:{id:"_2-3-查看短信日志"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-查看短信日志"}},[t._v("#")]),t._v(" 2.3 查看短信日志")]),t._v(" "),e("p",[t._v("① 使用钉钉，扫码 "),e("a",{attrs:{href:"/img/%E7%9F%AD%E4%BF%A1%E9%85%8D%E7%BD%AE/07.jpg"}},[t._v("图片")]),t._v(" 加入机器人所在的【ruoyi-vue-pro 短信测试群】，查看测试短信的模拟发送。")]),t._v(" "),e("p",[t._v("② 点击 [测试] 按钮，输入任一手机号，进行该短信模板的模拟发送。如下图所示：")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/%E7%9F%AD%E4%BF%A1%E9%85%8D%E7%BD%AE/08.png",alt:"测试短信模板"}})]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/%E7%9F%AD%E4%BF%A1%E9%85%8D%E7%BD%AE/09.png",alt:"测试短信模板"}})]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("友情提示：如果使用的短信渠道是阿里云、腾讯云等正式的短信平台，则会发送到填写的手机号中。例如说：")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/%E7%9F%AD%E4%BF%A1%E9%85%8D%E7%BD%AE/10.png",alt:"接收示例"}})])]),t._v(" "),e("p",[t._v("③ 点击 [系统管理 -> 消息中心 -> 短信管理 -> 短信日志] 采单，可以查看到每条短信的发送状态、接收状态。如下图所示：")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/%E7%9F%AD%E4%BF%A1%E9%85%8D%E7%BD%AE/11.png",alt:"短信日志"}})]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("常见问题：为什么日志的接受状态，一直处理“等待结果”？")]),t._v(" "),e("p",[t._v("因为你没配置短信回调 URL，导致短信平台无法回调我们的系统，所以一直等待结果。具体怎么配置，可见 "),e("a",{attrs:{href:"#_6-%E7%9F%AD%E4%BF%A1%E5%B9%B3%E5%8F%B0%E9%99%84%E5%BD%95"}},[t._v("短信平台附录")]),t._v(" 小节。")])]),t._v(" "),e("h2",{attrs:{id:"_3-短信发送"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-短信发送"}},[t._v("#")]),t._v(" 3. 短信发送")]),t._v(" "),e("h3",{attrs:{id:"_3-1-smssendapi"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-smssendapi"}},[t._v("#")]),t._v(" 3.1 SmsSendApi")]),t._v(" "),e("p",[t._v("使用 "),e("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-system/src/main/java/cn/iocoder/yudao/module/system/api/sms/SmsSendApi.java",target:"_blank",rel:"noopener noreferrer"}},[t._v("SmsSendApi"),e("OutboundLink")],1),t._v(" 进行短信的发送，支持多种用户类型。它的方法如下：")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/%E7%9F%AD%E4%BF%A1%E9%85%8D%E7%BD%AE/21.png",alt:"短信发送"}})]),t._v(" "),e("h3",{attrs:{id:"_3-2-实战案例"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-实战案例"}},[t._v("#")]),t._v(" 3.2 实战案例")]),t._v(" "),e("p",[t._v("以工作流申请通过时，发送短信为例子，讲解 SmsSendApi 的使用。")]),t._v(" "),e("p",[t._v("① 引入 "),e("code",[t._v("yudao-module-system")]),t._v(" 依赖，如下图所示：")]),t._v(" "),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[t._v("图片纠错：最新版本引入 `yudao-module-system` 依赖即可，因为 `yudao-module-system-api` 已经合并到 `yudao-module-system` 中。")])]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/%E7%9F%AD%E4%BF%A1%E9%85%8D%E7%BD%AE/22.png",alt:" 依赖"}})]),t._v(" "),e("p",[t._v("② 新建对应的短信模板，如下图所示：")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/%E7%9F%AD%E4%BF%A1%E9%85%8D%E7%BD%AE/23.png",alt:"新建短信模板"}})]),t._v(" "),e("p",[t._v("③ 使用 Spring 注入 SmsSendApi Bean，调用对应的短信发送方法。如下图所示：")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/%E7%9F%AD%E4%BF%A1%E9%85%8D%E7%BD%AE/24.png",alt:"调用 SmsSendApi 方法"}})]),t._v(" "),e("h2",{attrs:{id:"_4-验证码发送"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-验证码发送"}},[t._v("#")]),t._v(" 4. 验证码发送")]),t._v(" "),e("h3",{attrs:{id:"_4-1-smscodeapi"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-smscodeapi"}},[t._v("#")]),t._v(" 4.1 SmsCodeApi")]),t._v(" "),e("p",[t._v("使用 "),e("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-system/src/main/java/cn/iocoder/yudao/module/system/api/sms/SmsCodeApi.java",target:"_blank",rel:"noopener noreferrer"}},[t._v("SmsCodeApi"),e("OutboundLink")],1),t._v(" 进行【验证码】短信的发送，例如说：用户手机验证码登录、用户忘记密码等等。它的方法如下：")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/%E7%9F%AD%E4%BF%A1%E9%85%8D%E7%BD%AE/21.png",alt:"短信发送"}})]),t._v(" "),e("p",[t._v("验证码使用 "),e("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-system/src/main/java/cn/iocoder/yudao/module/system/dal/dataobject/sms/SmsCodeDO.java",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("system_sms_code")]),e("OutboundLink")],1),t._v(" 表进行存储，默认每天最多发送 10 条，每分钟发送 1 条，有效期为 10 分钟，可通过 "),e("code",[t._v("yudao.sms-code")]),t._v(" 配置项进行自定义：")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/%E7%9F%AD%E4%BF%A1%E9%85%8D%E7%BD%AE/32.png",alt:" 配置项"}})]),t._v(" "),e("h3",{attrs:{id:"_4-2-实战案例"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-实战案例"}},[t._v("#")]),t._v(" 4.2 实战案例")]),t._v(" "),e("p",[t._v("以会员用户手机验证码登录为例子，讲解 SmsCodeApi 的使用。")]),t._v(" "),e("p",[t._v("① 引入 "),e("code",[t._v("yudao-module-system")]),t._v(" 依赖，如下图所示：")]),t._v(" "),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[t._v("图片纠错：最新版本引入 `yudao-module-system` 依赖即可，因为 `yudao-module-system-api` 已经合并到 `yudao-module-system` 中。")])]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/%E7%9F%AD%E4%BF%A1%E9%85%8D%E7%BD%AE/34.png",alt:" 依赖"}})]),t._v(" "),e("p",[t._v("② 新建对应的短信模板，如下图所示：")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/%E7%9F%AD%E4%BF%A1%E9%85%8D%E7%BD%AE/35.png",alt:"新建短信模板"}})]),t._v(" "),e("p",[t._v("③ 在 "),e("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-system/src/main/java/cn/iocoder/yudao/module/system/enums/sms/SmsSceneEnum.java",target:"_blank",rel:"noopener noreferrer"}},[t._v("SmsSceneEnum"),e("OutboundLink")],1),t._v(" 中，枚举会员用户的手机号登录的场景，如下图所示：")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/%E7%9F%AD%E4%BF%A1%E9%85%8D%E7%BD%AE/36.png",alt:"SmsSceneEnum 枚举"}})]),t._v(" "),e("p",[t._v("④ 使用 Spring 注入 SmsCodeApi Bean，调用对应的短信验证码的发送与使用方法。如下图所示：")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/%E7%9F%AD%E4%BF%A1%E9%85%8D%E7%BD%AE/33.png",alt:"调用 SmsCodeApi 方法"}})]),t._v(" "),e("h2",{attrs:{id:"_5-短信客户端"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-短信客户端"}},[t._v("#")]),t._v(" 5. 短信客户端")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/tree/master/yudao-module-system/src/main/java/cn/iocoder/yudao/module/system/framework/sms",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("frameowrk/sms")]),e("OutboundLink")],1),t._v(" 短信【组件】，对接阿里云、腾讯云等短信平台，提供统一的短信客户端，提供给 "),e("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-system/src/main/java/cn/iocoder/yudao/module/system/service/sms/",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("service/sms")]),e("OutboundLink")],1),t._v(" 短信【业务】模块来调用。")]),t._v(" "),e("h3",{attrs:{id:"_5-1-smsclient"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-smsclient"}},[t._v("#")]),t._v(" 5.1 SmsClient")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-system/src/main/java/cn/iocoder/yudao/module/system/framework/sms/core/client/SmsClient.java",target:"_blank",rel:"noopener noreferrer"}},[t._v("SmsClient"),e("OutboundLink")],1),t._v(" 接口，定义短信客户端的方法。代码如下：")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/%E7%9F%AD%E4%BF%A1%E9%85%8D%E7%BD%AE/41.png",alt:"SmsClient 接口"}})]),t._v(" "),e("p",[t._v("每个短信平台，都对应一个 SmsClient 实现类。")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/%E7%9F%AD%E4%BF%A1%E9%85%8D%E7%BD%AE/42.png",alt:"SmsClient 实现"}})]),t._v(" "),e("h3",{attrs:{id:"_5-2-对接其它短信平台"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-对接其它短信平台"}},[t._v("#")]),t._v(" 5.2 对接其它短信平台")]),t._v(" "),e("p",[t._v("如果你想要对接其它短信平台，自定义一个 SmsClient 实现类，并使用 "),e("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-system/src/main/java/cn/iocoder/yudao/module/system/framework/sms/core/client/impl/SmsClientFactoryImpl.java#L73-L85",target:"_blank",rel:"noopener noreferrer"}},[t._v("SmsClientFactoryImpl"),e("OutboundLink")],1),t._v(" 进行创建。代码如下：")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/%E7%9F%AD%E4%BF%A1%E9%85%8D%E7%BD%AE/45.png",alt:"SmsClientFactoryImpl 创建客户端"}})]),t._v(" "),e("h2",{attrs:{id:"_6-短信平台附录"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-短信平台附录"}},[t._v("#")]),t._v(" 6. 短信平台附录")]),t._v(" "),e("p",[t._v("一般情况下，建议接入 2-3 个短信平台，避免某个短信平台故障时，影响业务的正常运行。")]),t._v(" "),e("p",[t._v("例如说，手机验证码的短信平台 A 故障时，赶紧将短信验证码切换到短信平台 B 上，否则用户将无法正常登录或是注册。")]),t._v(" "),e("h3",{attrs:{id:"_6-1-阿里云"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-阿里云"}},[t._v("#")]),t._v(" 6.1 阿里云")]),t._v(" "),e("p",[t._v("① 短信 API 的账号、密钥，可通过 "),e("a",{attrs:{href:"https://ram.console.aliyun.com/manage/ak",target:"_blank",rel:"noopener noreferrer"}},[t._v("阿里云 —— AccessKey"),e("OutboundLink")],1),t._v(" 获取。")]),t._v(" "),e("p",[t._v("② 短信发送回调 URL，可通过 "),e("a",{attrs:{href:"https://dysms.console.aliyun.com/general/upward",target:"_blank",rel:"noopener noreferrer"}},[t._v("阿里云 —— 短信服务 —— 通用设置"),e("OutboundLink")],1),t._v(" 配置。它对应的是 SmsCallbackController 的 "),e("code",[t._v("#receiveAliyunSmsStatus(...)")]),t._v(" 地址。")]),t._v(" "),e("h3",{attrs:{id:"_6-2-腾讯云"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-腾讯云"}},[t._v("#")]),t._v(" 6.2 腾讯云")]),t._v(" "),e("p",[t._v("① 短信 API 的账号、密钥，可通过 "),e("a",{attrs:{href:"https://console.cloud.tencent.com/cam/capi",target:"_blank",rel:"noopener noreferrer"}},[t._v("腾讯云 —— API 密钥管理"),e("OutboundLink")],1),t._v(" 获取。")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("注意！！！")]),t._v(" "),e("p",[t._v("腾讯云需要额外使用 "),e("a",{attrs:{href:"https://console.cloud.tencent.com/smsv2/app-manage",target:"_blank",rel:"noopener noreferrer"}},[t._v("SDKAppID"),e("OutboundLink")],1),t._v(" 参数，它的账号需要采用 "),e("code",[t._v("secretId SDKAppID")]),t._v(" 格式。")]),t._v(" "),e("p",[t._v("例如说：在“API 密钥管理”获得了 "),e("code",[t._v("SecretId")]),t._v(" 为 "),e("code",[t._v("A")]),t._v("，"),e("code",[t._v("SecretKey")]),t._v(" 为 "),e("code",[t._v("B")]),t._v("，在“SDKAppID”获得了 "),e("code",[t._v("SDKAppID")]),t._v(" 为 "),e("code",[t._v("18")]),t._v("，则配置短信 API 的账号为 "),e("code",[t._v("A 18")]),t._v("，短信 API 的密钥为 "),e("code",[t._v("B")]),t._v("。")])]),t._v(" "),e("p",[t._v("② 短信发送回调 URL，可通过 "),e("a",{attrs:{href:"https://console.cloud.tencent.com/smsv2/app-setting",target:"_blank",rel:"noopener noreferrer"}},[t._v("腾讯云 —— 短信 —— 基础配置"),e("OutboundLink")],1),t._v(" 配置。它对应的是 SmsCallbackController 的 "),e("code",[t._v("#receiveTencentSmsStatus(...)")]),t._v(" 地址。")]),t._v(" "),e("h3",{attrs:{id:"_6-3-华为云"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-3-华为云"}},[t._v("#")]),t._v(" 6.3 华为云")]),t._v(" "),e("p",[t._v("① 短信 API 的账号、密钥，可通过 "),e("a",{attrs:{href:"https://console.huaweicloud.com/iam/?#/mine/accessKey",target:"_blank",rel:"noopener noreferrer"}},[t._v("华为云 —— 访问密钥"),e("OutboundLink")],1),t._v(" 获取。")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("注意！！！")]),t._v(" "),e("p",[t._v("华为云需要额外使用 sender 通道号，它的账号需要采用 "),e("code",[t._v("AccessKeyId sender")]),t._v(" 格式。")]),t._v(" "),e("p",[t._v("例如说：在“华为云访问密钥”获得了 "),e("code",[t._v("AccessKeyId")]),t._v(" 为 "),e("code",[t._v("A")]),t._v("，"),e("code",[t._v("SecretAccessKey")]),t._v(" 为 "),e("code",[t._v("B")]),t._v("，在“华为云签名”获得了 "),e("code",[t._v("sender")]),t._v(" 为 "),e("code",[t._v("8824060312575")]),t._v("，则配置短信 API 的账号为 "),e("code",[t._v("A 8824060312575")]),t._v("，短信 API 的密钥为 "),e("code",[t._v("B")]),t._v("。")])]),t._v(" "),e("p",[t._v("② 短信发送回调 URL，可以通过我们项目的 [系统管理 -> 消息中心 -> 短信管理 -> 短信渠道] 菜单，配置它的“短信发送回调 URL”字段即可。它对应的是 SmsCallbackController 的 "),e("code",[t._v("#receiveHuaweiSmsStatus(...)")]),t._v(" 地址。")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("补充说明：如果发送短信时，提示“405 鉴权失败”的话，怎么办？")]),t._v(" "),e("p",[t._v("可参考 "),e("a",{attrs:{href:"https://gitee.com/zhijiantianya/yudao-cloud/issues/IASUWI",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://gitee.com/zhijiantianya/yudao-cloud/issues/IASUWI"),e("OutboundLink")],1),t._v(" 说明，我目前暂时没碰到过，不确定是不是这么解决是合理的~")])]),t._v(" "),e("h3",{attrs:{id:"_6-4-七牛云"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-4-七牛云"}},[t._v("#")]),t._v(" 6.4 七牛云")]),t._v(" "),e("p",[t._v("① 短信 API 的账号、密钥，可通过 "),e("a",{attrs:{href:"https://portal.qiniu.com/developer/user/key",target:"_blank",rel:"noopener noreferrer"}},[t._v("七牛云 —— 密钥管理"),e("OutboundLink")],1),t._v(" 获取。")]),t._v(" "),e("p",[t._v("② 短信发送回调 URL，可通过 "),e("a",{attrs:{href:"https://portal.qiniu.com/sms/settings",target:"_blank",rel:"noopener noreferrer"}},[t._v("七牛云 —— 云短信 —— 设置"),e("OutboundLink")],1),t._v(" 配置。它对应的是 SmsCallbackController 的 "),e("code",[t._v("#receiveQiniuSmsStatus(...)")]),t._v(" 地址。")]),t._v(" "),e("h3",{attrs:{id:"_6-5-更多短信平台"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-5-更多短信平台"}},[t._v("#")]),t._v(" 6.5 更多短信平台")]),t._v(" "),e("p",[t._v("短信平台非常的多，欢迎给我们 pull request 贡献。")]),t._v(" "),e("p",[t._v("例如说：合一、云片、京东云、容联云、亿美软通、天翼云、网易云等等。")]),t._v(" "),e("p",[t._v("如果你想参与，可以添加 "),e("code",[t._v("wangwenbin-server")]),t._v(" 微信好，备注“短信”即可。")])])}),[],!1,null,null,null);e.default=r.exports}}]);