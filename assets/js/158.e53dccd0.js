(window.webpackJsonp=window.webpackJsonp||[]).push([[158],{514:function(t,e,s){"use strict";s.r(e);var a=s(15),n=Object(a.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("前置阅读：")]),t._v(" "),e("ul",[e("li",[e("RouterLink",{attrs:{to:"/ai/tool/"}},[t._v("《AI 工具（function calling）》")])],1),t._v(" "),e("li",[e("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/27327515233",target:"_blank",rel:"noopener noreferrer"}},[t._v("《一文看懂：MCP(大模型上下文协议)》"),e("OutboundLink")],1)]),t._v(" "),e("li",[t._v("「可选」"),e("a",{attrs:{href:"https://gitee.com/zhijiantianya/ruoyi-vue-pro/commit/369ca68",target:"_blank",rel:"noopener noreferrer"}},[t._v("《项目接入 MCP Client 代码》"),e("OutboundLink")],1)])])]),t._v(" "),e("p",[t._v("目前，项目的 "),e("RouterLink",{attrs:{to:"/ai/chat/"}},[t._v("AI 聊天对话")]),t._v(" 功能，也已经接入 MCP Client 客户端，如下图所示：")],1),t._v(" "),e("p",[e("img",{attrs:{src:"/img/AI%E6%89%8B%E5%86%8C/MCP_Client/MCP_Client%E7%9A%84%E6%A1%88%E4%BE%8B.png",alt:"MCP Client 的案例"}})]),t._v(" "),e("h2",{attrs:{id:"_1-如何配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-如何配置"}},[t._v("#")]),t._v(" 1. 如何配置？")]),t._v(" "),e("p",[t._v("① 本地需要启动一个你想调用的 MCP Server 服务，例如说：")]),t._v(" "),e("div",{staticClass:"language-Bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## https://www.npmjs.com/package/@agent-infra/mcp-server-filesystem")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 注意：<dir> 需要替换成你想开放的目录")]),t._v("\n\nnpx @agent-infra/mcp-server-filesystem "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--port")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("8089")]),t._v(" --allowed-directories "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("dir"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),e("p",[t._v("启动完成后，可以浏览器访问 "),e("a",{attrs:{href:"http://127.0.0.1:8089/sse",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://127.0.0.1:8089/sse"),e("OutboundLink")],1),t._v(" 是否通了。")]),t._v(" "),e("p",[t._v("② 在项目的 "),e("code",[t._v("application.yaml")]),t._v(" 中，配置 "),e("code",[t._v("spring.ai.mcp.client")]),t._v(" 配置项，配置对应的 MCP Client ，如下所示：")]),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spring")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ai")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("mcp")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("client")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("enabled")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mcp\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("sse")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("connections")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("filesystem")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n              "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("url")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//127.0.0.1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("8089")]),t._v("\n              "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("sse-endpoint")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /sse\n")])])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("友情提示：")]),t._v(" "),e("p",[t._v("具体每个配置项的作用，可见 "),e("a",{attrs:{href:"https://docs.spring.io/spring-ai/reference/api/mcp/mcp-client-boot-starter-docs.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("《Spring AI 官方文档 —— MCP Client Boot Starter》"),e("OutboundLink")],1),t._v(" 文档。")])]),t._v(" "),e("hr"),t._v(" "),e("p",[t._v("接着启动后端项目，可以看到 "),e("code",[t._v("INFO io.modelcontextprotocol.client.McpAsyncClient")]),t._v(" 日志，表示 MCP Client 启动成功。")]),t._v(" "),e("h2",{attrs:{id:"_2-如何使用-所有工具"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-如何使用-所有工具"}},[t._v("#")]),t._v(" 2. 如何使用（所有工具）？")]),t._v(" "),e("p",[t._v("一个 MCP 会有多个工具，例如说上面 "),e("code",[t._v("mcp")]),t._v(" Client 连接的 "),e("code",[t._v("filesystem")]),t._v(" Server，就提供了 "),e("code",[t._v("read_file")]),t._v("、"),e("code",[t._v("write_file")]),t._v("、"),e("code",[t._v("list_directory")]),t._v(" 等多个工具，如何进行使用？")]),t._v(" "),e("p",[t._v("① 第一步，在数据字典菜单，配置 "),e("code",[t._v("ai_mcp_client_name")]),t._v(" 字典，添加在 "),e("code",[t._v("${spring.ai.mcp.client.sse.connections}")]),t._v(" 里的名字，例如说："),e("code",[t._v("filesystem")]),t._v("。如下图所示：")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/AI%E6%89%8B%E5%86%8C/MCP_Client/%E6%95%B0%E6%8D%AE%E5%AD%97%E5%85%B8%E9%85%8D%E7%BD%AE.png",alt:"数据字典配置"}})]),t._v(" "),e("p",[t._v("② 第二步，在角色配置时，关联对应的 AI 工具，可多选。如下图所示：")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/AI%E6%89%8B%E5%86%8C/MCP_Client/%E5%B7%A5%E5%85%B7%E8%A7%92%E8%89%B2%E9%85%8D%E7%BD%AE_mcp.png",alt:"AI 工具角色配置（MCP）"}})]),t._v(" "),e("p",[t._v("③ 第三步，使用该角色进行聊天，即可使用 AI 工具。如下图所示：")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/AI%E6%89%8B%E5%86%8C/MCP_Client/MCP_Client%E7%9A%84%E6%A1%88%E4%BE%8B_mcp.png",alt:"MCP Client 的案例（MCP）"}})]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("友情提示：")]),t._v(" "),e("p",[t._v("本质上，MCP Client 会转换成 AI 工具调用的方式：MCP Tool 转换为 function calling 的 Tool 定义，进而提交给大模型进行推理使用。")])]),t._v(" "),e("h2",{attrs:{id:"_3-如何使用-单个工具"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-如何使用-单个工具"}},[t._v("#")]),t._v(" 3. 如何使用（单个工具）？")]),t._v(" "),e("p",[t._v("如果只想使用 MCP Client 连接的 MCP Server 的某一个工具，例如说 "),e("code",[t._v("read_file")]),t._v(" 工具，如何进行使用？")]),t._v(" "),e("p",[t._v("① 第一步，在 [AI 大模型 -> 控制台 -> AI 工具管理] 菜单，创建工具（关联 MCP 工具）。")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/AI%E6%89%8B%E5%86%8C/MCP_Client/%E5%B7%A5%E5%85%B7%E7%AE%A1%E7%90%86.png",alt:"AI 工具"}})]),t._v(" "),e("p",[t._v("MCP 工具名字的生成规则可见 McpToolUtils 的 "),e("code",[t._v("#prefixedToolName(...)")]),t._v(" 方法，总结来说就是 "),e("code",[t._v("${spring.ai.mcp.client.name}_${spring.ai.mcp.client.sse.connections.serverName}_<toolName>")]),t._v("。")]),t._v(" "),e("p",[t._v("例如说我们上面：")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("${spring.ai.mcp.client.name}")]),t._v(" 是 "),e("code",[t._v("mcp")])]),t._v(" "),e("li",[e("code",[t._v("${spring.ai.mcp.client.sse.connections.serverName}")]),t._v(" 是 "),e("code",[t._v("filesystem")])]),t._v(" "),e("li",[e("code",[t._v("<toolName>")]),t._v(" 是 "),e("code",[t._v("read_file")])])]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("疑问：我要怎么知道 MCP Server 提供了哪些工具？")]),t._v(" "),e("p",[t._v("可以使用类似 Cursor、Copilot 等 AI 工具连接该 MCP Server，然后就能看到它提供了哪些工具。")])]),t._v(" "),e("p",[t._v("② 第二步，在角色配置时，关联对应的 AI 工具，可多选。如下图所示：")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/AI%E6%89%8B%E5%86%8C/MCP_Client/%E5%B7%A5%E5%85%B7%E8%A7%92%E8%89%B2%E9%85%8D%E7%BD%AE.png",alt:"AI 工具角色配置"}})]),t._v(" "),e("p",[t._v("③ 第三步，使用该角色进行聊天，即可使用 AI 工具。如下图所示：")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/AI%E6%89%8B%E5%86%8C/MCP_Client/MCP_Client%E7%9A%84%E6%A1%88%E4%BE%8B.png",alt:"MCP Client 的案例"}})])])}),[],!1,null,null,null);e.default=n.exports}}]);