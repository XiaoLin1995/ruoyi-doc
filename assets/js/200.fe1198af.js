(window.webpackJsonp=window.webpackJsonp||[]).push([[200],{558:function(t,a,s){"use strict";s.r(a);var e=s(15),n=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[t._v("本小节，讲解如何将前端 + 后端项目，"),a("strong",[t._v("使用 Docker 容器")]),t._v("，部署到 dev 开发环境下的一台 Linux 服务器上。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/Docker%E9%83%A8%E7%BD%B2/01.png",alt:"Docker 部署"}})]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("注意：服务器的 IP 地址。")]),t._v(" "),a("ul",[a("li",[t._v("外网 IP：139.9.196.247 或 8.154.33.209")]),t._v(" "),a("li",[t._v("内网 IP：192.168.0.213 或 172.26.126.182")])]),t._v(" "),a("p",[t._v("下属所有涉及到 IP 的配置，需要替换成你自己的。")])]),t._v(" "),a("h2",{attrs:{id:"_1-环境准备"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-环境准备"}},[t._v("#")]),t._v(" 1. 环境准备")]),t._v(" "),a("p",[t._v("需要安装如下环境：")]),t._v(" "),a("ul",[a("li",[t._v("Docker：容器")]),t._v(" "),a("li",[t._v("MySQL：数据库")]),t._v(" "),a("li",[t._v("Redis：缓存")]),t._v(" "),a("li",[t._v("Nginx：负载均衡")])]),t._v(" "),a("h3",{attrs:{id:"_1-1-安装-docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-安装-docker"}},[t._v("#")]),t._v(" 1.1 安装 Docker")]),t._v(" "),a("p",[t._v("执行如下命令，进行 Docker 的安装。参考自 "),a("a",{attrs:{href:"https://help.aliyun.com/zh/ecs/use-cases/install-and-use-docker-on-a-linux-ecs-instance",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://help.aliyun.com/zh/ecs/use-cases/install-and-use-docker-on-a-linux-ecs-instance"),a("OutboundLink")],1),t._v(" 文档。")]),t._v(" "),a("div",{staticClass:"language-Bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ① 运行以下命令，安装 Docker 存储驱动的依赖包")]),t._v("\ndnf "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-y")]),t._v(" device-mapper-persistent-data lvm2\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ② 添加稳定的 Docker 软件源")]),t._v("\ndnf config-manager --add-repo"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ③ 检查 Docker 软件源是否已添加")]),t._v("\ndnf list docker-ce\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ④ 安装 Docker")]),t._v("\ndnf "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-y")]),t._v(" docker-ce "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--nobest")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ⑤ 查看 docker 版本信息：返回 Docker version 27.3.1, build ce12230")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ⑥ 启动 Docker 守护进程，并设置开机自启动")]),t._v("\nsystemctl start "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v("\nsystemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("enable")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v("\n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("补充说明：由于访问 Docker 镜像不稳定，一般建议加速访问！！！")]),t._v(" "),a("p",[t._v("问题反馈：")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://t.zsxq.com/sfdMJ",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://t.zsxq.com/sfdMJ"),a("OutboundLink")],1)])]),t._v(" "),a("p",[t._v("可参考加速方式：")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/DaoCloud/public-image-mirror",target:"_blank",rel:"noopener noreferrer"}},[t._v("DaoCloud / public-image-mirror"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/kubesre/docker-registry-mirrors",target:"_blank",rel:"noopener noreferrer"}},[t._v("kubesre / docker-registry-mirrors"),a("OutboundLink")],1)])])]),t._v(" "),a("h3",{attrs:{id:"_1-2-安装-mysql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-安装-mysql"}},[t._v("#")]),t._v(" 1.2 安装 MySQL")]),t._v(" "),a("h4",{attrs:{id:"第一步-安装-mysql-可选"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第一步-安装-mysql-可选"}},[t._v("#")]),t._v(" 第一步，安装 MySQL（可选）")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("友情提示：使用 Docker 安装 MySQL 是可选步骤，也可以直接安装 MySQL，或者购买 MySQL 云服务。")])]),t._v(" "),a("p",[t._v("① 执行如下命令，使用 Docker 启动 MySQL 容器。")]),t._v(" "),a("div",{staticClass:"language-Bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" /work/mysql/:/var/lib/mysql "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v(":3306 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-e")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("MYSQL_ROOT_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("123456")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--restart")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("always "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--name")]),t._v(" mysql "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-d")]),t._v(" m.daocloud.io/docker.io/mysql\n")])])]),a("ul",[a("li",[t._v("数据库文件，挂载到服务器的的 "),a("code",[t._v("/work/mysql/")]),t._v(" 目录下")]),t._v(" "),a("li",[t._v("端口是 3306，密码是 123456")])]),t._v(" "),a("p",[t._v("② 执行 "),a("code",[t._v("ls /work/mysql")]),t._v(" 命令，查看 "),a("code",[t._v("/work/mysql/")]),t._v(" 目录的数据库文件。")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/Docker%E9%83%A8%E7%BD%B2/03.png",alt:"数据库文件"}})]),t._v(" "),a("h4",{attrs:{id:"第二步-导入-sql-脚本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第二步-导入-sql-脚本"}},[t._v("#")]),t._v(" 第二步，导入 SQL 脚本")]),t._v(" "),a("p",[t._v("创建一个名字为 "),a("code",[t._v("ruoyi-vue-pro")]),t._v(" 数据库，执行数据库对应的 "),a("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/tree/master/sql",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("sql")]),a("OutboundLink")],1),t._v(" 目录下的 SQL 文件，进行初始化。")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/Docker%E9%83%A8%E7%BD%B2/02.png",alt:"使用 Navicat 导入 SQL 脚本"}})]),t._v(" "),a("h3",{attrs:{id:"_1-3-安装-redis"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-安装-redis"}},[t._v("#")]),t._v(" 1.3 安装 Redis")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("友情提示：使用 Docker 安装 Redis 是可选步骤，也可以直接安装 Redis，或者购买 Redis 云服务。")])]),t._v(" "),a("p",[t._v("执行如下命令，使用 Docker 启动 Redis 容器。")]),t._v(" "),a("div",{staticClass:"language-Bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-d")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--name")]),t._v(" redis "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--restart")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("always "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6379")]),t._v(":6379 m.daocloud.io/docker.io/redis\n")])])]),a("ul",[a("li",[t._v("端口是 6379，密码未设置")])]),t._v(" "),a("h3",{attrs:{id:"_1-4-安装-nginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-安装-nginx"}},[t._v("#")]),t._v(" 1.4 安装 Nginx")]),t._v(" "),a("h4",{attrs:{id:"第一步-创建挂载目录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第一步-创建挂载目录"}},[t._v("#")]),t._v(" 第一步，创建挂载目录")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("Nginx 挂载到服务器的目录：")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("/work/nginx/conf.d")]),t._v(" 用于存放配置文件")]),t._v(" "),a("li",[a("code",[t._v("/work/nginx/html")]),t._v(" 用于存放网页文件")]),t._v(" "),a("li",[a("code",[t._v("/work/nginx/logs")]),t._v(" 用于存放日志")]),t._v(" "),a("li",[a("code",[t._v("/work/nginx/cert")]),t._v(" 用于存放 HTTPS 证书")])])]),t._v(" "),a("p",[t._v("创建 "),a("code",[t._v("/work/nginx")]),t._v(" 目录，并在该目录下新建 "),a("code",[t._v("nginx.conf")]),t._v(" 文件，避免稍后安装 Nginx 报错。内容如下：")]),t._v(" "),a("div",{staticClass:"language-Bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("user  nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nworker_processes  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nevents "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    worker_connections  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nerror_log  /var/log/nginx/error.log warn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\npid        /var/run/nginx.pid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nhttp "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    include       /etc/nginx/mime.types"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    default_type  application/octet-stream"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    sendfile        on"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    keepalive_timeout  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("65")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    log_format  main  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'$remote_addr - $remote_user [$time_local] \"$request\" '")]),t._v("\n                      "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'$status $body_bytes_sent \"$http_referer\" '")]),t._v("\n                      "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'"$http_user_agent" "$http_x_forwarded_for"\'')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#    access_log  /var/log/nginx/access.log  main;")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("gzip")]),t._v(" on"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    gzip_min_length 1k"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("     "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 设置允许压缩的页面最小字节数")]),t._v("\n    gzip_buffers "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" 16k"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("     "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 用来存储 gzip 的压缩结果")]),t._v("\n    gzip_http_version "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 识别 HTTP 协议版本")]),t._v("\n    gzip_comp_level "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 设置 gzip 的压缩比 1-9。1 压缩比最小但最快，而 9 相反")]),t._v("\n    gzip_types text/plain application/x-javascript text/css application/xml application/javascript"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定压缩类型")]),t._v("\n    gzip_proxied any"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("       "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 无论后端服务器的 headers 头返回什么信息，都无条件启用压缩")]),t._v("\n\n    include /etc/nginx/conf.d/*.conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 加载该目录下的其它 Nginx 配置文件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h4",{attrs:{id:"启动-nginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动-nginx"}},[t._v("#")]),t._v(" 启动 Nginx")]),t._v(" "),a("p",[t._v("① 执行如下命令，使用 Docker 启动 Nginx 容器。")]),t._v(" "),a("div",{staticClass:"language-Bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-d")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--name")]),t._v(" nginx "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--restart")]),t._v(" always "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v(":80 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("443")]),t._v(":443 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-e")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"TZ=Asia/Shanghai"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" /work/nginx/nginx.conf:/etc/nginx/nginx.conf "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" /work/nginx/conf.d:/etc/nginx/conf.d "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" /work/nginx/logs:/var/log/nginx "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" /work/nginx/cert:/etc/nginx/cert "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" /work/nginx/html:/usr/share/nginx/html "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\nm.daocloud.io/docker.io/nginx\n")])])]),a("p",[t._v("② 执行 "),a("code",[t._v("docker ps")]),t._v(" 命令，查看到 Nginx 容器的状态是 "),a("code",[t._v("UP")]),t._v(" 的。")]),t._v(" "),a("h2",{attrs:{id:"_2-部署后端服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-部署后端服务"}},[t._v("#")]),t._v(" 2. 部署后端服务")]),t._v(" "),a("h4",{attrs:{id:"第一步-修改配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第一步-修改配置"}},[t._v("#")]),t._v(" 第一步，修改配置")]),t._v(" "),a("p",[t._v("后端 dev 开发环境对应的是 "),a("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-server/src/main/resources/application-dev.yaml",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("application-dev.yaml")]),a("OutboundLink")],1),t._v(" 配置文件，主要是修改 MySQL 和 Redis 为你的地址。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/Linux%E9%83%A8%E7%BD%B2/03.png",alt:" 配置文件"}})]),t._v(" "),a("h4",{attrs:{id:"第二步-编译后端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第二步-编译后端"}},[t._v("#")]),t._v(" 第二步，编译后端")]),t._v(" "),a("p",[t._v("在项目的根目录下，执行 "),a("code",[t._v("mvn clean package -Dmaven.test.skip=true")]),t._v(" 命令，编译后端项目，构建出它的 Jar 包。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/Linux%E9%83%A8%E7%BD%B2/02.png",alt:"编译后端"}})]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("疑问：-Dmaven.test.skip=true 是什么意思？")]),t._v(" "),a("p",[t._v("跳过单元测试的执行。如果你项目的单元测试写的不错，建议使用 "),a("code",[t._v("mvn clean package")]),t._v(" 命令，执行单元测试，保证交付的质量。")])]),t._v(" "),a("h4",{attrs:{id:"第三步-上传-jar-包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第三步-上传-jar-包"}},[t._v("#")]),t._v(" 第三步，上传 Jar 包")]),t._v(" "),a("p",[t._v("在 Linux 服务器上创建 "),a("code",[t._v("/work/projects/yudao-server")]),t._v(" 目录，使用 "),a("code",[t._v("scp")]),t._v(" 命令或者 FTP 工具，将 "),a("code",[t._v("yudao-server.jar")]),t._v(" 上传到该目录下。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/Linux%E9%83%A8%E7%BD%B2/04.png",alt:"上传 Jar 包"}})]),t._v(" "),a("h4",{attrs:{id:"第四步-构建镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第四步-构建镜像"}},[t._v("#")]),t._v(" 第四步，构建镜像")]),t._v(" "),a("p",[t._v("① 在 "),a("code",[t._v("/work/projects/yudao-server")]),t._v(" 目录下，新建 Dockerfile 文件，用于制作后端项目的 Docker 镜像。编写内容如下：")]),t._v(" "),a("div",{staticClass:"language-Bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## AdoptOpenJDK 停止发布 OpenJDK 二进制，而 Eclipse Temurin 是它的延伸，提供更好的稳定性")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 感谢复旦核博士的建议！灰子哥，牛皮！")]),t._v("\nFROM m.daocloud.io/docker.io/eclipse-temurin:8-jre\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 创建目录，并使用它作为工作目录")]),t._v("\nRUN "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" /yudao-server\nWORKDIR /yudao-server\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 将后端项目的 Jar 文件，复制到镜像中")]),t._v("\nCOPY yudao-server.jar app.jar\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 设置 TZ 时区")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('## 设置 JAVA_OPTS 环境变量，可通过 docker run -e "JAVA_OPTS=" 进行覆盖')]),t._v("\nENV "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("TZ")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Asia/Shanghai "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("JAVA_OPTS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-Xms512m -Xmx512m"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 暴露后端项目的 48080 端口")]),t._v("\nEXPOSE "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("48080")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 启动后端项目")]),t._v("\nENTRYPOINT "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("java")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${JAVA_OPTS}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-Djava.security.egd")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("file:/dev/./urandom "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-jar")]),t._v(" app.jar\n")])])]),a("p",[t._v("② 执行如下命令，构建名字为 "),a("code",[t._v("yudao-server")]),t._v(" 的 Docker 镜像。")]),t._v(" "),a("div",{staticClass:"language-Bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /work/projects/yudao-server\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" build "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-t")]),t._v(" yudao-server "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\n")])])]),a("p",[t._v("③ 在 "),a("code",[t._v("/work/projects/yudao-server")]),t._v(" 目录下，新建 Shell 脚本 "),a("code",[t._v("deploy.sh")]),t._v("，使用 Docker 启动后端项目。编写内容如下：")]),t._v(" "),a("div",{staticClass:"language-Bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/bin/bash")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-e")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 第一步：删除可能启动的老 yudao-server 容器")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"开始删除 yudao-server 容器"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" stop yudao-server "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" yudao-server "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"完成删除 yudao-server 容器"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 第二步：启动新的 yudao-server 容器 \\")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"开始启动 yudao-server 容器"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-d")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--name")]),t._v(" yudao-server "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("48080")]),t._v(":48080 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-e")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SPRING_PROFILES_ACTIVE=dev"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" /work/projects/yudao-server:/root/logs/ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\nyudao-server\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"正在启动 yudao-server 容器中，需要等待 60 秒左右"')]),t._v("\n")])])]),a("ul",[a("li",[t._v("应用日志文件，挂载到服务器的的 "),a("code",[t._v("/work/projects/yudao-server")]),t._v(" 目录下")]),t._v(" "),a("li",[t._v("通过 "),a("code",[t._v("SPRING_PROFILES_ACTIVE")]),t._v(" 设置为 "),a("code",[t._v("dev")]),t._v(" 开发环境")])]),t._v(" "),a("h4",{attrs:{id:"第五步-启动后端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第五步-启动后端"}},[t._v("#")]),t._v(" 第五步，启动后端")]),t._v(" "),a("p",[t._v("① 执行 "),a("code",[t._v("sh deploy.sh")]),t._v(" 命令，使用 Docker 启动后端项目。日志如下：")]),t._v(" "),a("div",{staticClass:"language-Bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("开始删除 yudao-server 容器\nyudao-server\nyudao-server\n完成删除 yudao-server 容器\n开始启动 yudao-server 容器\n0dfd3dc409a53ae6b5e7c5662602cf5dcb52fd4d7f673bd74af7d21da8ead9d5\n正在启动 yudao-server 容器中，需要等待 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("60")]),t._v(" 秒左右\n")])])]),a("p",[t._v("② 执行 "),a("code",[t._v("docker logs yudao-server")]),t._v(" 命令，查看启动日志。看到如下内容，说明启动完成：")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("友情提示：如果日志比较多，可以使用 grep 进行过滤。")]),t._v(" "),a("p",[t._v("例如说：使用 "),a("code",[t._v("docker logs yudao-server | grep 48080")])])]),t._v(" "),a("div",{staticClass:"language-Bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-04-15 00:34:19.647  INFO "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(" --- "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("TID: N/A"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" o.s.b.w.embedded.tomcat.TomcatWebServer  "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" Tomcat initialized with port"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("48080")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h2",{attrs:{id:"_3-部署前端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-部署前端"}},[t._v("#")]),t._v(" 3. 部署前端")]),t._v(" "),a("p",[t._v("项目的管理后台有 3 个版本（只需要看你的版本即可）：")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("yudao-ui-admin-vue3")]),t._v("：基于 Vue3 + element-plus")]),t._v(" "),a("li",[a("code",[t._v("yudao-ui-admin-vben")]),t._v("：基于 Vue3 + vben5(ant-design-vue、element-plus)")]),t._v(" "),a("li",[a("code",[t._v("yudao-ui-admin-vue2")]),t._v("：基于 Vue2 + element-ui")])]),t._v(" "),a("p",[t._v("注意，前端无法直接启动，而是需要通过 Nginx 转发读取前端构建出来的静态文件，最终都放在服务器上的 "),a("code",[t._v("/work/projects/yudao-ui-admin")]),t._v(" 目录下。")]),t._v(" "),a("h3",{attrs:{id:"_3-1-yudao-ui-admin-vue3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-yudao-ui-admin-vue3"}},[t._v("#")]),t._v(" 3.1 yudao-ui-admin-vue3")]),t._v(" "),a("p",[t._v("基于 Vue3 + element-plus")]),t._v(" "),a("h4",{attrs:{id:"第一步-修改配置-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第一步-修改配置-2"}},[t._v("#")]),t._v(" 第一步，修改配置")]),t._v(" "),a("p",[t._v("前端 dev 开发环境对应的是 "),a("a",{attrs:{href:"https://github.com/yudaocode/yudao-ui-admin-vue3/blob/master/.env.dev#L6-L7",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v(".env.dev")]),a("OutboundLink")],1),t._v(" 配置文件，主要是修改 "),a("code",[t._v("VITE_BASE_URL")]),t._v(" 为你的后端项目的访问地址。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/Linux%E9%83%A8%E7%BD%B2/ep-env.png",alt:" 配置文件"}})]),t._v(" "),a("h4",{attrs:{id:"第二步-编译前端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第二步-编译前端"}},[t._v("#")]),t._v(" 第二步，编译前端")]),t._v(" "),a("p",[t._v("在前端项目的根目录下，执行 "),a("code",[t._v("npm run build:dev")]),t._v(" 命令，编译前端项目，构建出它的 "),a("code",[t._v("dist")]),t._v(" 文件，里面是 HTML、CSS、JavaScript 等静态文件。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/Linux%E9%83%A8%E7%BD%B2/ep-%E7%BC%96%E8%AF%91.png",alt:"编译前端"}})]),t._v(" "),a("p",[t._v("如下想要打包其它环境，可使用如下命令：")]),t._v(" "),a("div",{staticClass:"language-Bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run build:prod "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 打包 prod 生产环境")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run build:stage "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 打包 stage 预发布环境")]),t._v("\n")])])]),a("p",[t._v("如果是在服务器上构建，并且出现卡死的情况，可以参考 "),a("a",{attrs:{href:"https://t.zsxq.com/Quq1U",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://t.zsxq.com/Quq1U"),a("OutboundLink")],1),t._v(" 或 "),a("a",{attrs:{href:"https://gitee.com/yudaocode/yudao-ui-admin-vue3/issues/IAU0T3",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://gitee.com/yudaocode/yudao-ui-admin-vue3/issues/IAU0T3"),a("OutboundLink")],1),t._v(" 解决")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("其它高级参数说明【可暂时不看】：")]),t._v(" "),a("p",[t._v("① "),a("code",[t._v("VITE_PUBLIC_PATH")]),t._v("：前端打包的路径（静态资源的基础路径），一般默认为 "),a("code",[t._v("/")]),t._v(" 即可。目前有两种用法：")]),t._v(" "),a("p",[t._v("第一种，可用于二级目录部署。例如说，"),a("code",[t._v("VITE_PUBLIC_PATH")]),t._v(" 设置为 "),a("code",[t._v("/demo")]),t._v(" 。然后 Nginx 配置时，需要特殊注意，如下所示：")]),t._v(" "),a("div",{staticClass:"language-Bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("        location /demo "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注意点 1：不需要 / 结尾")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注意点 2：二级路由时需要使用别名 alias，不用 root")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("alias")]),t._v("   /work/projects/yudao-ui-admin/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注意点 3：需要 / 结尾")]),t._v("\n            index  index.html index.htm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            try_files "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v("/ /index.html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("第二种，可用于七牛等 CDN 服务，读取前端的静态文件，提升访问速度，建议 prod 生产环境使用。例如说，我们演示环境的 "),a("code",[t._v("VITE_PUBLIC_PATH")]),t._v(" 是 "),a("code",[t._v("http://static-vue3.yudao.iocoder.cn/")]),t._v(" 。")]),t._v(" "),a("p",[t._v("具体操作，可参考文章的 "),a("a",{attrs:{href:"https://blog.csdn.net/weixin_71403100/article/details/132037721",target:"_blank",rel:"noopener noreferrer"}},[t._v("《Vue 项目使用七牛云 CDN 存放静态资源》"),a("OutboundLink")],1),t._v(" 的「二、实现方式 」部分，只是最终的“修改 index.html 中静态资源引用”，变成 "),a("code",[t._v("PUBLIC_PATH")]),t._v(" 修改即可。")])]),t._v(" "),a("h4",{attrs:{id:"第三步-上传-dist-文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第三步-上传-dist-文件"}},[t._v("#")]),t._v(" 第三步，上传 "),a("code",[t._v("dist")]),t._v(" 文件")]),t._v(" "),a("p",[t._v("在 Linux 服务器上创建 "),a("code",[t._v("/work/projects/yudao-ui-admin")]),t._v(" 目录，使用 "),a("code",[t._v("scp")]),t._v(" 命令或者 FTP 工具，将 "),a("code",[t._v("dist")]),t._v(" 上传到该目录下。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/Linux%E9%83%A8%E7%BD%B2/ep-dist.png",alt:"上传  文件"}})]),t._v(" "),a("h3",{attrs:{id:"_3-2-yudao-ui-admin-vben"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-yudao-ui-admin-vben"}},[t._v("#")]),t._v(" 3.2 yudao-ui-admin-vben")]),t._v(" "),a("p",[t._v("基于 Vue3 + vben5(ant-design-vue、element-plus)。")]),t._v(" "),a("p",[t._v("下面主要以 ant-design-vue 为例，element-plus 类似。")]),t._v(" "),a("h4",{attrs:{id:"第一步-修改配置-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第一步-修改配置-3"}},[t._v("#")]),t._v(" 第一步，修改配置")]),t._v(" "),a("p",[t._v("前端 production 开发环境对应的是 "),a("a",{attrs:{href:"https://github.com/yudaocode/yudao-ui-admin-vben/blob/master/apps/web-antd/.env.production#L3-L8",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v(".env.production")]),a("OutboundLink")],1),t._v(" 配置文件，主要是修改 "),a("code",[t._v("VITE_BASE_URL")]),t._v("、"),a("code",[t._v("VITE_GLOB_API_URL")]),t._v(" 为你的后端项目的访问地址。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/Linux%E9%83%A8%E7%BD%B2/vben-env.png",alt:" 配置文件"}})]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("其它高级参数说明【可暂时不看】：")]),t._v(" "),a("p",[t._v("① "),a("code",[t._v("VITE_BASE")]),t._v("：前端打包的路径（静态资源的基础路径），一般默认为 "),a("code",[t._v("/")]),t._v(" 即可。目前有两种用法：")]),t._v(" "),a("p",[t._v("第一种，可用于二级目录部署。例如说，"),a("code",[t._v("VITE_BASE")]),t._v(" 设置为 "),a("code",[t._v("/demo")]),t._v(" 。然后 Nginx 配置时，需要特殊注意，如下所示：")]),t._v(" "),a("div",{staticClass:"language-Bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("        location /demo "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注意点 1：不需要 / 结尾")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注意点 2：二级路由时需要使用别名 alias，不用 root")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("alias")]),t._v("   /work/projects/yudao-ui-admin/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注意点 3：需要 / 结尾")]),t._v("\n            index  index.html index.htm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            try_files "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v("/ /index.html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("第二种，可用于七牛等 CDN 服务，读取前端的静态文件，提升访问速度，建议 prod 生产环境使用。例如说，我们演示环境的 "),a("code",[t._v("VITE_BASE")]),t._v(" 是 "),a("code",[t._v("http://static-vue3.yudao.iocoder.cn/")]),t._v(" 。")]),t._v(" "),a("p",[t._v("具体操作，可参考文章的 "),a("a",{attrs:{href:"https://blog.csdn.net/weixin_71403100/article/details/132037721",target:"_blank",rel:"noopener noreferrer"}},[t._v("《Vue 项目使用七牛云 CDN 存放静态资源》"),a("OutboundLink")],1),t._v(" 的「二、实现方式 」部分，只是最终的“修改 index.html 中静态资源引用”，变成 "),a("code",[t._v("PUBLIC_PATH")]),t._v(" 修改即可。")])]),t._v(" "),a("h4",{attrs:{id:"第二步-编译前端-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第二步-编译前端-2"}},[t._v("#")]),t._v(" 第二步，编译前端")]),t._v(" "),a("p",[t._v("在前端项目的根目录下，执行 "),a("code",[t._v("npm run build:antd")]),t._v(" 或 "),a("code",[t._v("npm run build:ele")]),t._v(" 命令，编译前端项目，构建出它的 "),a("code",[t._v("dist.zip")]),t._v(" 压缩包，里面是 HTML、CSS、JavaScript 等静态文件。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/Linux%E9%83%A8%E7%BD%B2/vben-%E7%BC%96%E8%AF%91.png",alt:"编译前端"}})]),t._v(" "),a("h4",{attrs:{id:"第三步-上传-dist-文件-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第三步-上传-dist-文件-2"}},[t._v("#")]),t._v(" 第三步，上传 "),a("code",[t._v("dist")]),t._v(" 文件")]),t._v(" "),a("p",[t._v("在 Linux 服务器上创建 "),a("code",[t._v("/work/projects/yudao-ui-admin")]),t._v(" 目录，使用 "),a("code",[t._v("scp")]),t._v(" 命令或者 FTP 工具，将 "),a("code",[t._v("dist")]),t._v(" 上传到该目录下。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/Linux%E9%83%A8%E7%BD%B2/vben-dist.png",alt:"上传  文件"}})]),t._v(" "),a("h3",{attrs:{id:"_4-3-yudao-ui-admin-vue2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-yudao-ui-admin-vue2"}},[t._v("#")]),t._v(" 4.3 yudao-ui-admin-vue2")]),t._v(" "),a("p",[t._v("基于 Vue2 + element-ui")]),t._v(" "),a("h4",{attrs:{id:"第一步-修改配置-4"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第一步-修改配置-4"}},[t._v("#")]),t._v(" 第一步，修改配置")]),t._v(" "),a("p",[t._v("前端 dev 开发环境对应的是 "),a("a",{attrs:{href:"https://github.com/yudaocode/yudao-ui-admin-vue2/blob/master/.env.dev",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v(".env.dev")]),a("OutboundLink")],1),t._v(" 配置文件，主要是修改 "),a("code",[t._v("VUE_APP_BASE_API")]),t._v(" 为你的后端项目的访问地址。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/Linux%E9%83%A8%E7%BD%B2/eu-env.png",alt:" 配置文件"}})]),t._v(" "),a("h4",{attrs:{id:"第二步-编译前端-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第二步-编译前端-3"}},[t._v("#")]),t._v(" 第二步，编译前端")]),t._v(" "),a("p",[t._v("在前端项目的根目录下，执行 "),a("code",[t._v("npm run build:dev")]),t._v(" 命令，编译前端项目，构建出它的 "),a("code",[t._v("dist")]),t._v(" 文件，里面是 HTML、CSS、JavaScript 等静态文件。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/Linux%E9%83%A8%E7%BD%B2/eu-%E7%BC%96%E8%AF%91.png",alt:"编译前端"}})]),t._v(" "),a("p",[t._v("如下想要打包其它环境，可使用如下命令：")]),t._v(" "),a("div",{staticClass:"language-Bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run build:prod "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 打包 prod 生产环境")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run build:stage "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 打包 stage 预发布环境")]),t._v("\n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("其它高级参数说明【可暂时不看】：")]),t._v(" "),a("p",[t._v("① "),a("code",[t._v("PUBLIC_PATH")]),t._v("：可用于七牛等 CDN 服务，读取前端的静态文件，提升访问速度，建议 prod 生产环境使用。示例如下：")]),t._v(" "),a("p",[t._v("可参考文章的 "),a("a",{attrs:{href:"https://blog.csdn.net/weixin_71403100/article/details/132037721",target:"_blank",rel:"noopener noreferrer"}},[t._v("《Vue 项目使用七牛云 CDN 存放静态资源》"),a("OutboundLink")],1),t._v(" 的「二、实现方式 」部分，只是最终的“修改 index.html 中静态资源引用”，变成 "),a("code",[t._v("PUBLIC_PATH")]),t._v(" 修改即可。")]),t._v(" "),a("p",[t._v("② "),a("code",[t._v("VUE_APP_APP_NAME")]),t._v("：二级部署路径，默认为 "),a("code",[t._v("/")]),t._v(" 根目录，一般不用修改。")]),t._v(" "),a("p",[t._v("③ "),a("code",[t._v("mode")]),t._v("：前端路由的模式，默认采用 "),a("code",[t._v("history")]),t._v(" 路由，一般不用修改。可以通过修改 "),a("a",{attrs:{href:"https://github.com/yudaocode/yudao-ui-admin-vue2/blob/master/src/router/index.js#L173-L178",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("router/index.js")]),a("OutboundLink")],1),t._v(" 来设置为 "),a("code",[t._v("hash")]),t._v(" 路由，示例如下：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/Linux%E9%83%A8%E7%BD%B2/eu-mode.png",alt:" 参数"}})])]),t._v(" "),a("h4",{attrs:{id:"第三步-上传-dist-文件-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第三步-上传-dist-文件-3"}},[t._v("#")]),t._v(" 第三步，上传 "),a("code",[t._v("dist")]),t._v(" 文件")]),t._v(" "),a("p",[t._v("在 Linux 服务器上创建 "),a("code",[t._v("/work/projects/yudao-ui-admin")]),t._v(" 目录，使用 "),a("code",[t._v("scp")]),t._v(" 命令或者 FTP 工具，将 "),a("code",[t._v("dist")]),t._v(" 上传到该目录下。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/Linux%E9%83%A8%E7%BD%B2/eu-dist.png",alt:"上传  文件"}})]),t._v(" "),a("p",[t._v("（图中的目录不太对，以文字为准！！！）")]),t._v(" "),a("h2",{attrs:{id:"_4-配置-nginx-转发"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-配置-nginx-转发"}},[t._v("#")]),t._v(" 4. 配置 Nginx 转发")]),t._v(" "),a("p",[t._v("两种 Nginx 的配置，分别满足服务器 IP、独立域名的不同场景。")]),t._v(" "),a("h3",{attrs:{id:"_4-1-方式一-服务器-ip-访问"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-方式一-服务器-ip-访问"}},[t._v("#")]),t._v(" 4.1 方式一：服务器 IP 访问")]),t._v(" "),a("p",[t._v("① 在 "),a("code",[t._v("/work/nginx/conf.d")]),t._v(" 目录下，创建 "),a("code",[t._v("ruoyi-vue-pro.conf")]),t._v("，内容如下：")]),t._v(" "),a("div",{staticClass:"language-Bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("server "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    listen       "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    server_name  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("139.9")]),t._v(".196.247"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 重要！！！修改成你的外网 IP/域名")]),t._v("\n\n    location / "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 前端项目")]),t._v("\n        root   /usr/share/nginx/html/yudao-ui-admin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        index  index.html index.htm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        try_files "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v("/ /index.html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    location /admin-api/ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 后端项目 - 管理后台")]),t._v("\n        proxy_pass http://192.168.0.213:48080/admin-api/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 重要！！！proxy_pass 需要设置为后端项目所在服务器的 IP")]),t._v("\n        proxy_set_header Host "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_host")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        proxy_set_header X-Real-IP "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$remote_addr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        proxy_set_header REMOTE-HOST "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$remote_addr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        proxy_set_header X-Forwarded-For "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$proxy_add_x_forwarded_for")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    location /app-api/ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 后端项目 - 用户 App")]),t._v("\n        proxy_pass http://192.168.0.213:48080/app-api/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 重要！！！proxy_pass 需要设置为后端项目所在服务器的 IP")]),t._v("\n        proxy_set_header Host "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_host")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        proxy_set_header X-Real-IP "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$remote_addr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        proxy_set_header REMOTE-HOST "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$remote_addr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        proxy_set_header X-Forwarded-For "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$proxy_add_x_forwarded_for")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("友情提示：")]),t._v(" "),a("p",[a("code",[t._v("[root]")]),t._v(" 指令在本地文件时，要使用 Nginx Docker 容器内的路径，即 "),a("code",[t._v("/usr/share/nginx/html/yudao-ui-admin")]),t._v("，否则会报 404 的错误。")])]),t._v(" "),a("p",[t._v("② 执行 "),a("code",[t._v("docker exec nginx nginx -s reload")]),t._v(" 命令，重新加载 Nginx 配置。")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("友情提示：如果你担心 Nginx 配置不正确，可以执行 docker exec nginx nginx -t 命令。")])]),t._v(" "),a("p",[t._v("③ 执行 "),a("code",[t._v("curl http://192.168.0.213/admin-api/")]),t._v(" 命令，成功访问后端项目的内网地址，返回结果如下：")]),t._v(" "),a("div",{staticClass:"language-JSON extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"code"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("401")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"data"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token null keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"msg"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"账号未登录"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("执行 "),a("code",[t._v("curl http://139.9.196.247:48080/admin-api/")]),t._v(" 命令（“需要换成你的外网 IP”），成功访问后端项目的外网地址，返回结果一致。")]),t._v(" "),a("p",[t._v("④ 请求 "),a("a",{attrs:{href:"http://139.9.196.247:48080",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://139.9.196.247:48080"),a("OutboundLink")],1),t._v(" 地址（“需要换成你的外网 IP”），成功访问前端项目的外网地址，，返回前端界面如下：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/Docker%E9%83%A8%E7%BD%B2/06.png",alt:"前端界面"}})]),t._v(" "),a("p",[t._v("⑤ 如果你使用到 WebSocket 的话，需要额外对 "),a("code",[t._v("/infra/ws")]),t._v(" 路径进行配置，具体可见 "),a("a",{attrs:{href:"https://t.zsxq.com/LQEfC",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://t.zsxq.com/LQEfC"),a("OutboundLink")],1),t._v(" 链接。")]),t._v(" "),a("h3",{attrs:{id:"_4-2-方式二-独立域名访问"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-方式二-独立域名访问"}},[t._v("#")]),t._v(" 4.2 方式二：独立域名访问")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("友情提示：在前端项目的编译时，需要把 `VUE_APP_BASE_API` 修改为后端项目对应的域名。")]),t._v(" "),a("p",[t._v("例如说，这里使用的是 "),a("code",[t._v("http://api.iocoder.cn")])])]),t._v(" "),a("p",[t._v("① 在 "),a("code",[t._v("/work/nginx/conf.d")]),t._v(" 目录下，创建 "),a("code",[t._v("ruoyi-vue-pro2.conf")]),t._v("，内容如下：")]),t._v(" "),a("div",{staticClass:"language-Bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("server "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 前端项目")]),t._v("\n    listen       "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    server_name  admin.iocoder.cn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 重要！！！修改成你的前端域名")]),t._v("\n\n    location / "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 前端项目")]),t._v("\n        root   /usr/share/nginx/html/yudao-ui-admin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        index  index.html index.htm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        try_files "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v("/ /index.html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nserver "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 后端项目")]),t._v("\n    listen       "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    server_name  api.iocoder.cn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 重要！！！修改成你的外网 IP/域名")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 不要使用 location / 转发到后端项目，因为 druid、admin 等监控，不需要外网可访问。或者增加 Nginx IP 白名单限制也可以。")]),t._v("\n\n    location /admin-api/ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 后端项目 - 管理后台")]),t._v("\n        proxy_pass http://192.168.0.213:48080/admin-api/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 重要！！！proxy_pass 需要设置为后端项目所在服务器的 IP")]),t._v("\n        proxy_set_header Host "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_host")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        proxy_set_header X-Real-IP "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$remote_addr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        proxy_set_header REMOTE-HOST "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$remote_addr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        proxy_set_header X-Forwarded-For "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$proxy_add_x_forwarded_for")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    location /app-api/ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 后端项目 - 用户 App")]),t._v("\n        proxy_pass http://192.168.0.213:48080/app-api/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 重要！！！proxy_pass 需要设置为后端项目所在服务器的 IP")]),t._v("\n        proxy_set_header Host "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_host")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        proxy_set_header X-Real-IP "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$remote_addr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        proxy_set_header REMOTE-HOST "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$remote_addr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        proxy_set_header X-Forwarded-For "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$proxy_add_x_forwarded_for")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("② 执行 "),a("code",[t._v("docker exec nginx nginx -s reload")]),t._v(" 命令，重新加载 Nginx 配置。")]),t._v(" "),a("p",[t._v("③ 请求 "),a("a",{attrs:{href:"http://api.iocoder.cn/admin-api/",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://api.iocoder.cn/admin-api/"),a("OutboundLink")],1),t._v(" 地址，成功访问后端项目，返回结果如下：")]),t._v(" "),a("div",{staticClass:"language-JSON extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"code"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("401")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"data"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token null keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"msg"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"账号未登录"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("④ 请求 "),a("a",{attrs:{href:"http://admin.iocoder.cn",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://admin.iocoder.cn"),a("OutboundLink")],1),t._v(" 地址，成功访问前端项目，返回前端界面如下：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/Linux%E9%83%A8%E7%BD%B2/15.png",alt:"前端界面"}})]),t._v(" "),a("h2",{attrs:{id:"_666-更多说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_666-更多说明"}},[t._v("#")]),t._v(" 666. 更多说明")]),t._v(" "),a("p",[t._v("① 积木报表菜单，无法访问。参考 "),a("a",{attrs:{href:"https://t.zsxq.com/vBkup",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://t.zsxq.com/vBkup"),a("OutboundLink")],1),t._v(" 解决。")]),t._v(" "),a("p",[t._v("② 如果希望分离 Maven 依赖 lib 打包，可参考 "),a("a",{attrs:{href:"https://gitee.com/zhijiantianya/ruoyi-vue-pro/pulls/1259/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://gitee.com/zhijiantianya/ruoyi-vue-pro/pulls/1259/"),a("OutboundLink")],1),t._v(" 贡献。")]),t._v(" "),a("p",[t._v("③ Swagger 接口的转发，参考 "),a("a",{attrs:{href:"https://t.zsxq.com/IpALd",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://t.zsxq.com/IpALd"),a("OutboundLink")],1),t._v(" 和 "),a("a",{attrs:{href:"https://t.zsxq.com/9p9Xu",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://t.zsxq.com/9p9Xu"),a("OutboundLink")],1),t._v(" 解决。")]),t._v(" "),a("p",[t._v("④ 关于 Nginx，如何部署的一点分享，来自球友 "),a("a",{attrs:{href:"https://t.zsxq.com/H5KKy",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://t.zsxq.com/H5KKy"),a("OutboundLink")],1),t._v(" 投稿。")])])}),[],!1,null,null,null);a.default=n.exports}}]);